/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	// The require scope
/******/ 	var __webpack_require__ = {};
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
__webpack_require__.r(__webpack_exports__);
var canvas = document.createElement('canvas');
var ctx = canvas.getContext("2d");
document.body.appendChild(canvas);
var grid = [];
var grid_size = 20;
var fps = 5;
var width = Math.floor(window.innerWidth / grid_size) * grid_size;
var height = Math.floor(window.innerHeight / grid_size) * grid_size;
canvas.width = width;
canvas.height = height;
function reset() {
    grid = [];
    for (var x = 0; x < width / grid_size; x++) {
        var temp_array = [];
        for (var y = 0; y < height / grid_size; y++) {
            temp_array.push(false);
        }
        grid.push(temp_array);
    }
}
reset();
function drawSquare(x, y, s, state) {
    if (state === void 0) { state = false; }
    ctx.fillStyle = state ? "white" : "black";
    ctx.fillRect(x, y, s, s);
}
function glider(x, y) {
    grid[x][y] = false;
    grid[x + 1][y] = false;
    grid[x + 2][y] = true;
    grid[x][y + 1] = true;
    grid[x + 1][y + 1] = false;
    grid[x + 2][y + 1] = true;
    grid[x][y + 2] = false;
    grid[x + 1][y + 2] = true;
    grid[x + 2][y + 2] = true;
}
glider(0, 0);
glider(5, 5);
glider(10, 5);
glider(10, 10);
grid[21][20] = true;
grid[22][20] = true;
grid[23][20] = true;
function updateGol(oldgrid) {
    var newgrid = [];
    var gh = oldgrid[0].length;
    var gw = oldgrid.length;
    for (var x = 0; x < gw; x++) {
        var temp_array = [];
        for (var y = 0; y < gh; y++) {
            var total = 0;
            // check the number of neighboring cells
            for (var i = -1; i <= 1; i++) {
                for (var j = -1; j <= 1; j++) {
                    if ((i !== 0 || j !== 0) && oldgrid[(x + i + gw) % gw][(y + j + gh) % gh]) {
                        total++;
                    }
                }
            }
            if (oldgrid[x][y] && (total == 2 || total == 3)) {
                temp_array.push(true);
            }
            else if (!oldgrid[x][y] && (total == 3)) {
                temp_array.push(true);
            }
            else {
                temp_array.push(false);
            }
        }
        newgrid.push(temp_array);
    }
    return newgrid;
}
function render(rendergrid) {
    if (rendergrid === void 0) { rendergrid = grid; }
    console.log(rendergrid.length);
    for (var x = 0; x < width / grid_size; x++) {
        for (var y = 0; y < height / grid_size; y++) {
            drawSquare(x * grid_size, y * grid_size, grid_size, rendergrid[x][y]);
        }
    }
}
function step() {
    grid = updateGol(grid);
    console.log(grid);
    render(grid);
}
var enabled = true;
setInterval(function () {
    if (enabled)
        step();
}, 1000 / fps);
addEventListener("keypress", function (ev) {
    switch (ev.key) {
        case "s":
            if (!enabled) {
                step();
            }
            break;
        case "t":
        case " ":
            enabled = !enabled;
            break;
        case "r":
            reset();
            glider(5, 5);
            break;
    }
});
step();


/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FFdEU7S0FDRjtBQUNILENBQUM7QUFDRCxTQUFTLElBQUk7SUFDWCxJQUFJLEdBQUcsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3ZCLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbEIsTUFBTSxDQUFDLElBQUksQ0FBQztBQUNkLENBQUM7QUFDRCxJQUFJLE9BQU8sR0FBRyxJQUFJO0FBQ2xCLFdBQVcsQ0FBQztJQUNWLElBQUksT0FBTztRQUFFLElBQUksRUFBRTtBQUNyQixDQUFDLEVBQUUsSUFBSSxHQUFHLEdBQUcsQ0FBQztBQUNkLGdCQUFnQixDQUFDLFVBQVUsRUFBRSxVQUFDLEVBQUU7SUFDOUIsUUFBUSxFQUFFLENBQUMsR0FBRyxFQUFFO1FBQ2QsS0FBSyxHQUFHO1lBQ04sSUFBSSxDQUFDLE9BQU8sRUFBRTtnQkFDWixJQUFJLEVBQUU7YUFDUDtZQUVELE1BQUs7UUFDUCxLQUFLLEdBQUcsQ0FBQztRQUNULEtBQUssR0FBRztZQUNOLE9BQU8sR0FBRyxDQUFDLE9BQU87WUFDbEIsTUFBSztRQUNQLEtBQUssR0FBRztZQUNOLEtBQUssRUFBRTtZQUNQLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ1osTUFBSztLQUNSO0FBQ0gsQ0FBQyxDQUFDO0FBQ0YsSUFBSSxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWZnajIwMjMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vbWZnajIwMjMvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly9tZmdqMjAyMy8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcbmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2FudmFzKTtcbnR5cGUgc3RhdGUyZCA9IGJvb2xlYW5bXVtdO1xubGV0IGdyaWQ6IHN0YXRlMmQgPSBbXTtcbmxldCBncmlkX3NpemUgPSAyMDtcbmxldCBmcHMgPSA1O1xuXG5sZXQgd2lkdGggPSBNYXRoLmZsb29yKHdpbmRvdy5pbm5lcldpZHRoIC8gZ3JpZF9zaXplKSAqIGdyaWRfc2l6ZTtcbmxldCBoZWlnaHQgPSBNYXRoLmZsb29yKHdpbmRvdy5pbm5lckhlaWdodCAvIGdyaWRfc2l6ZSkgKiBncmlkX3NpemU7XG5jYW52YXMud2lkdGggPSB3aWR0aDtcbmNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG5mdW5jdGlvbiByZXNldCgpIHtcbiAgZ3JpZCA9IFtdO1xuICBmb3IgKGxldCB4ID0gMDsgeCA8IHdpZHRoIC8gZ3JpZF9zaXplOyB4KyspIHtcbiAgICBsZXQgdGVtcF9hcnJheTogYm9vbGVhbltdID0gW107XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCBoZWlnaHQgLyBncmlkX3NpemU7IHkrKykge1xuICAgICAgdGVtcF9hcnJheS5wdXNoKGZhbHNlKVxuICAgIH1cbiAgICBncmlkLnB1c2godGVtcF9hcnJheSlcblxuICB9XG59XG5yZXNldCgpXG5mdW5jdGlvbiBkcmF3U3F1YXJlKHg6IG51bWJlciwgeTogbnVtYmVyLCBzOiBudW1iZXIsIHN0YXRlOiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHtcbiAgY3R4LmZpbGxTdHlsZSA9IHN0YXRlID8gXCJ3aGl0ZVwiIDogXCJibGFja1wiO1xuICBjdHguZmlsbFJlY3QoeCwgeSwgcywgcyk7XG5cbn1cbmZ1bmN0aW9uIGdsaWRlcih4OiBudW1iZXIsIHk6IG51bWJlcik6IHZvaWQge1xuICBncmlkW3hdW3ldID0gZmFsc2VcbiAgZ3JpZFt4ICsgMV1beV0gPSBmYWxzZVxuICBncmlkW3ggKyAyXVt5XSA9IHRydWVcbiAgZ3JpZFt4XVt5ICsgMV0gPSB0cnVlXG4gIGdyaWRbeCArIDFdW3kgKyAxXSA9IGZhbHNlXG4gIGdyaWRbeCArIDJdW3kgKyAxXSA9IHRydWVcbiAgZ3JpZFt4XVt5ICsgMl0gPSBmYWxzZVxuICBncmlkW3ggKyAxXVt5ICsgMl0gPSB0cnVlXG4gIGdyaWRbeCArIDJdW3kgKyAyXSA9IHRydWVcbn1cbmdsaWRlcigwLCAwKVxuZ2xpZGVyKDUsIDUpXG5nbGlkZXIoMTAsIDUpXG5nbGlkZXIoMTAsIDEwKVxuZ3JpZFsyMV1bMjBdID0gdHJ1ZVxuZ3JpZFsyMl1bMjBdID0gdHJ1ZVxuZ3JpZFsyM11bMjBdID0gdHJ1ZVxuZnVuY3Rpb24gdXBkYXRlR29sKG9sZGdyaWQ6IHN0YXRlMmQpOiBzdGF0ZTJkIHtcbiAgbGV0IG5ld2dyaWQ6IHN0YXRlMmQgPSBbXTtcbiAgbGV0IGdoID0gb2xkZ3JpZFswXS5sZW5ndGhcbiAgbGV0IGd3ID0gb2xkZ3JpZC5sZW5ndGhcblxuICBmb3IgKGxldCB4ID0gMDsgeCA8IGd3OyB4KyspIHtcbiAgICBsZXQgdGVtcF9hcnJheTogYm9vbGVhbltdID0gW107XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCBnaDsgeSsrKSB7XG4gICAgICBsZXQgdG90YWw6IG51bWJlciA9IDA7XG5cbiAgICAgIC8vIGNoZWNrIHRoZSBudW1iZXIgb2YgbmVpZ2hib3JpbmcgY2VsbHNcblxuICAgICAgZm9yIChsZXQgaSA9IC0xOyBpIDw9IDE7IGkrKykge1xuICAgICAgICBmb3IgKGxldCBqID0gLTE7IGogPD0gMTsgaisrKSB7XG4gICAgICAgICAgaWYgKChpICE9PSAwIHx8IGogIT09IDApICYmIG9sZGdyaWRbKHggKyBpICsgZ3cpICUgZ3ddWyh5ICsgaiArIGdoKSAlIGdoXSkge1xuICAgICAgICAgICAgdG90YWwrKztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChvbGRncmlkW3hdW3ldICYmICh0b3RhbCA9PSAyIHx8IHRvdGFsID09IDMpKSB7XG4gICAgICAgIHRlbXBfYXJyYXkucHVzaCh0cnVlKVxuICAgICAgfVxuICAgICAgZWxzZSBpZiAoIW9sZGdyaWRbeF1beV0gJiYgKHRvdGFsID09IDMpKSB7XG4gICAgICAgIHRlbXBfYXJyYXkucHVzaCh0cnVlKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGVtcF9hcnJheS5wdXNoKGZhbHNlKVxuICAgICAgfVxuICAgIH1cbiAgICBuZXdncmlkLnB1c2godGVtcF9hcnJheSlcbiAgfVxuICByZXR1cm4gbmV3Z3JpZDtcbn1cbmZ1bmN0aW9uIHJlbmRlcihyZW5kZXJncmlkOiBzdGF0ZTJkID0gZ3JpZCkge1xuICBjb25zb2xlLmxvZyhyZW5kZXJncmlkLmxlbmd0aClcbiAgZm9yIChsZXQgeCA9IDA7IHggPCB3aWR0aCAvIGdyaWRfc2l6ZTsgeCsrKSB7XG5cbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IGhlaWdodCAvIGdyaWRfc2l6ZTsgeSsrKSB7XG4gICAgICBkcmF3U3F1YXJlKHggKiBncmlkX3NpemUsIHkgKiBncmlkX3NpemUsIGdyaWRfc2l6ZSwgcmVuZGVyZ3JpZFt4XVt5XSlcblxuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gc3RlcCgpIHtcbiAgZ3JpZCA9IHVwZGF0ZUdvbChncmlkKTtcbiAgY29uc29sZS5sb2coZ3JpZCk7XG4gIHJlbmRlcihncmlkKVxufVxubGV0IGVuYWJsZWQgPSB0cnVlXG5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gIGlmIChlbmFibGVkKSBzdGVwKClcbn0sIDEwMDAgLyBmcHMpXG5hZGRFdmVudExpc3RlbmVyKFwia2V5cHJlc3NcIiwgKGV2KSA9PiB7XG4gIHN3aXRjaCAoZXYua2V5KSB7XG4gICAgY2FzZSBcInNcIjpcbiAgICAgIGlmICghZW5hYmxlZCkge1xuICAgICAgICBzdGVwKClcbiAgICAgIH1cblxuICAgICAgYnJlYWtcbiAgICBjYXNlIFwidFwiOlxuICAgIGNhc2UgXCIgXCI6XG4gICAgICBlbmFibGVkID0gIWVuYWJsZWRcbiAgICAgIGJyZWFrXG4gICAgY2FzZSBcInJcIjpcbiAgICAgIHJlc2V0KClcbiAgICAgIGdsaWRlcig1LCA1KVxuICAgICAgYnJlYWtcbiAgfVxufSlcbnN0ZXAoKSJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==